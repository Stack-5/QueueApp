(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[381],{3633:(e,t,a)=>{Promise.resolve().then(a.bind(a,2470))},2470:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>Z});var s=a(5155),r=a(2115),l=a(4085),n=a(9602);let o=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});o.displayName="Card";let i=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",a),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("font-semibold leading-none tracking-tight",a),...r})});d.displayName="CardTitle";let c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});c.displayName="CardDescription";let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("p-6 pt-0",a),...r})});u.displayName="CardContent";let m=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,n.cn)("flex items-center p-6 pt-0",a),...r})});m.displayName="CardFooter";let f=r.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});f.displayName="Input";var x=a(6195);let p=(0,a(1027).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(x.b,{ref:t,className:(0,n.cn)(p(),a),...r})});h.displayName=x.b.displayName;var g=a(4850),y=a(2645),b=a(2488),j=a(7193);let N=g.bL,v=g.YJ,w=g.WT,k=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(g.l9,{ref:t,className:(0,n.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(g.In,{asChild:!0,children:(0,s.jsx)(y.A,{className:"h-4 w-4 opacity-50"})})]})});k.displayName=g.l9.displayName;let F=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(g.PP,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})});F.displayName=g.PP.displayName;let S=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(g.wn,{ref:t,className:(0,n.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(y.A,{className:"h-4 w-4"})})});S.displayName=g.wn.displayName;let C=r.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...o}=e;return(0,s.jsx)(g.ZL,{children:(0,s.jsxs)(g.UC,{ref:t,className:(0,n.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...o,children:[(0,s.jsx)(F,{}),(0,s.jsx)(g.LM,{className:(0,n.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(S,{})]})})});C.displayName=g.UC.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(g.JU,{ref:t,className:(0,n.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=g.JU.displayName;let R=r.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(g.q7,{ref:t,className:(0,n.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(g.VF,{children:(0,s.jsx)(j.A,{className:"h-4 w-4"})})}),(0,s.jsx)(g.p4,{children:r})]})});R.displayName=g.q7.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(g.wv,{ref:t,className:(0,n.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=g.wv.displayName;var z=a(5724);let q=z.bL;z.l9;let A=z.ZL,E=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(z.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});E.displayName=z.hJ.displayName;let B=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(A,{children:[(0,s.jsx)(E,{}),(0,s.jsx)(z.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});B.displayName=z.UC.displayName;let D=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};D.displayName="AlertDialogHeader";let I=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};I.displayName="AlertDialogFooter";let T=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(z.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...r})});T.displayName=z.hE.displayName;let U=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(z.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});U.displayName=z.VY.displayName;let V=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(z.rc,{ref:t,className:(0,n.cn)((0,l.r)(),a),...r})});V.displayName=z.rc.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(z.ZD,{ref:t,className:(0,n.cn)((0,l.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})}).displayName=z.ZD.displayName;var P=a(8569),_=a(6046),W=a(4448),J=a(2651),L=a(3205);let M=(e,t,a)=>{let[s,l]=(0,r.useState)(!0),[n,o]=(0,r.useState)([]),[i,d]=(0,r.useState)(null);return console.log(e),(0,r.useEffect)(()=>{(async()=>{if(0!==e.length)try{l(!0);let a=await J.A.post("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/available-stations"),{purpose:e},{headers:{Authorization:"Bearer ".concat(t)}});console.log(a.data.availableStations),o(a.data.availableStations)}catch(e){if((0,L.F0)(e)){var s;(null===(s=e.response)||void 0===s?void 0:s.status)===401&&(localStorage.removeItem("token"),a.replace("/error/unauthorized")),d(e.message)}else console.error(e),d(e.message)}finally{l(!1)}})()},[e]),{cashiers:n,isAvailableCashierFetching:s,error:i}},Q=e=>{let[t,a]=(0,r.useState)(""),[s,l]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{e&&(a(e),l(!0))},[e]),{alertMessage:t,isAlertOpen:s,setAlertMessage:a,setIsAlertOpen:l}},$=(e,t)=>{let a=e.target.value.replace(/\D/g,"");a.startsWith("0")&&(a="63"+a.slice(1)),a.startsWith("63")||(a="63"),a.length>12&&(a=a.slice(0,12)),t("+"+a)},O=async(e,t,a,s)=>{try{let{queueToken:r,queueNumber:l}=(await J.A.post("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/add"),{stationID:a,purpose:e,cellphoneNumber:t,timestamp:Date.now()},{headers:{Authorization:"Bearer ".concat(s)}})).data;return{queueToken:r,queueID:l}}catch(e){if((0,L.F0)(e)&&e.response){let{data:t}=e.response;throw Error(t.message||"An unexpected error occurred")}throw e}},Y=()=>{let[e,t]=(0,r.useState)(""),[a,n]=(0,r.useState)("+63"),[x,p]=(0,r.useState)(!1),g=(0,_.useRouter)(),[y,b]=(0,r.useState)(0),[j,F]=(0,r.useState)(!1),{token:S}=(0,P.W)(g),{cashiers:z,isAvailableCashierFetching:A,error:E}=M(e,S,g),{alertMessage:J,setAlertMessage:L,isAlertOpen:Y,setIsAlertOpen:Z}=Q(E);(0,r.useEffect)(()=>{let e=setTimeout(()=>p(!0),100);return()=>clearTimeout(e)},[]),(0,r.useEffect)(()=>{"0"===a[3]&&n(e=>e.slice(0,3)+e.slice(4))},[a]);let H=t=>{let{cashier:r}=t;return(0,s.jsxs)(o,{className:"border-2 border-[#FFC107] shadow-md w-full sm:max-w-lg min-w-[200px] mx-auto",children:[(0,s.jsxs)(i,{className:"flex flex-col justify-between items-start sm:items-center p-2 sm:p-4",children:[(0,s.jsx)("div",{className:"font-semibold text-sm sm:text-lg",children:r.name}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm",children:["Estimated Wait Time:"," ",(0,s.jsx)("span",{className:"text-red-600 font-bold",children:(0,W.A)((0,W.g)(r.queueSize))})]})]}),(0,s.jsxs)(u,{className:"px-2 sm:px-4 pb-2 text-xs sm:text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Location:"})," ",r.description]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"People in Queue:"})," ",r.queueSize]})]}),(0,s.jsx)(m,{className:"p-2 sm:p-4 flex justify-center",children:(0,s.jsx)(l.$,{className:"w-full max-w-xs bg-[#0077B6] text-white font-semibold hover:bg-blue-800 text-xs sm:text-sm",onClick:async()=>{try{F(!0);let{queueToken:t,queueID:s}=await O(e,a,r.id,S);localStorage.setItem("token",t),localStorage.setItem("queueID",s),console.log("token new",t),g.replace("/queue-status")}catch(t){let e=t.message;if("unauthorized"===e){g.replace("/error/unauthorized");return}if("server-error"===e){g.replace("/error/internal-server-error");return}L(e),Z(!0)}finally{F(!1)}},children:j?(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"w-5 h-5 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin"})}):"Enter Queue"})})]},r.id)};return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-6 pb-16 transition-all duration-700 ".concat(x?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-[#0077B6] text-center",children:["NEU",(0,s.jsx)("span",{className:"text-[#FFBF00]",children:"QUEUE"})]}),(0,s.jsx)("p",{className:"text-gray-700 mt-2 text-center font-bold text-sm sm:text-base",children:"Thank you for scanning!"}),(0,s.jsxs)("p",{className:"text-center text-gray-600 max-w-xs sm:max-w-md md:max-w-lg mt-2 font-bold text-xs sm:text-sm md:text-base",children:["Join a virtual queue and receive an SMS when it’s your turn. ⏳"," ",(0,s.jsx)("span",{className:"text-red-500 font-bold",children:"You have 10 minutes to submit the form"})," ","or scan the QR code again."]}),(0,s.jsx)("p",{className:"text-gray-600 mt-2 text-center text-xs sm:text-sm md:text-base",children:"Wait for an SMS notification shortly."}),(0,s.jsxs)(o,{className:"w-full max-w-md sm:max-w-lg mt-4 min-h-[300px] sm:min-h-[350px] md:min-h-[300px]",children:[(0,s.jsxs)(i,{children:[(0,s.jsx)(d,{children:0===y?"Required Section":"Select a Cashier"}),(0,s.jsx)(c,{children:0===y?"Enter your SMS details to proceed.":"Choose an available cashier and confirm."})]}),(0,s.jsx)(u,{children:0===y?(0,s.jsxs)("div",{className:"grid w-full gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(h,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsxs)(N,{onValueChange:t,value:e,children:[(0,s.jsx)(k,{id:"purpose",className:"border-[#FFBF00]",children:(0,s.jsx)(w,{placeholder:"Select a purpose"})}),(0,s.jsx)(C,{children:(0,s.jsx)(v,{children:["payment","auditing","clinic","registrar"].map(e=>(0,s.jsx)(R,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})})]})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(h,{htmlFor:"phone",children:"Cellphone Number (required)"}),(0,s.jsx)(f,{id:"phone",placeholder:"Enter your cellphone number",className:"border-[#FFBF00]",value:a,onChange:e=>$(e,n)})]})]}):(0,s.jsxs)("div",{className:"max-w-full sm:max-w-2xl mx-auto mt-1 p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Available Counters:"}),A?(0,s.jsx)(()=>(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"w-10 h-10 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin"})}),{}):(0,s.jsx)("div",{className:"space-y-4 max-h-80 overflow-y-auto w-full px-2 sm:px-4",children:z.map(e=>(0,s.jsx)(H,{cashier:e},e.id))})]})}),(0,s.jsx)(m,{className:"flex justify-between",children:0===y?(0,s.jsx)(l.$,{className:"w-40 bg-[#0077B6] text-[#FFBF00] font-bold",onClick:()=>b(1),disabled:!e||13!==a.length,children:"Proceed"}):(0,s.jsx)(l.$,{className:"w-20 bg-[#0077B6] text-[#FFBF00] font-bold",onClick:()=>b(0),children:"Back"})})]}),(0,s.jsx)("p",{className:"text-gray-600 font-extrabold mt-4 text-sm text-center",children:"Always check your notifications. Thank you!"}),(0,s.jsx)(q,{open:Y,onOpenChange:Z,children:(0,s.jsxs)(B,{children:[(0,s.jsxs)(D,{children:[(0,s.jsx)(T,{children:"Notification"}),(0,s.jsx)(U,{children:J})]}),(0,s.jsx)(I,{children:(0,s.jsx)(V,{onClick:()=>Z(!1),children:"OK"})})]})})]})},Z=()=>(0,s.jsx)(Y,{})},4085:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>i});var s=a(5155),r=a(2115),l=a(2317),n=a(1027),o=a(9602);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(i({variant:r,size:n,className:a})),ref:t,...c})});d.displayName="Button"},8569:(e,t,a)=>{"use strict";a.d(t,{W:()=>i});var s=a(2651),r=a(3205),l=a(7684),n=a(6046),o=a(2115);let i=e=>{let t=(0,n.usePathname)(),[a,i]=(0,o.useState)(null),[d,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let a=localStorage.getItem("token");if(console.log("in local storage",a),!a){e.replace("error/unauthorized");return}(async()=>{try{await s.A.get("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/verify-on-mount"),{headers:{Authorization:"Bearer ".concat(a)}});let r=(0,l.s)(a);c(r),"id"in r&&"/form"!==t?(console.log("[useVerifyValidToken] Detected newToken, redirecting to form."),e.replace("/form")):"queueID"in r&&"stationID"in r&&"/queue-status"!==t?(console.log("[useVerifyValidToken] Detected pendingToken, redirecting to queue-status."),e.replace("/queue-status")):"id"in r||"queueID"in r||(console.warn("[useVerifyValidToken] Unexpected token structure."),e.replace("/error/unauthorized")),i(a)}catch(t){if((0,r.F0)(t)){var n,o;console.log(null===(n=t.response)||void 0===n?void 0:n.data.message),(null===(o=t.response)||void 0===o?void 0:o.status)===401?(e.replace("/error/unauthorized"),localStorage.removeItem("token")):e.replace("/error/internal-server-error")}}})()},[]),{token:a,decodedToken:d}}},9602:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(3463),r=a(9795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},4448:(e,t,a)=>{"use strict";a.d(t,{A:()=>r,g:()=>s});let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e*t},r=e=>{let t=Math.floor(e/60),a=e%60;return t>0?"".concat(t,"h ").concat(a,"m"):"".concat(a,"m")}}},e=>{var t=t=>e(e.s=t);e.O(0,[451,365,359,441,517,358],()=>t(3633)),_N_E=e.O()}]);