(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{2721:(e,r,o)=>{Promise.resolve().then(o.bind(o,8468))},8468:(e,r,o)=>{"use strict";o.r(r),o.d(r,{default:()=>l});var t=o(5155),n=o(2651),a=o(3205),s=o(7684),i=o(6046),c=o(2115);let u=()=>{let e=(0,i.useSearchParams)(),r=(0,i.useRouter)(),[o,u]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{(async()=>{let o=e.get("token"),t=localStorage.getItem("token"),i=o||t;if(o&&localStorage.setItem("token",o),!i){console.warn("[processInitialQueueInformation] No token found. Redirecting to 401."),r.replace("/error/unauthorized");return}try{await n.A.get("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/notify-on-initial-mount"),{headers:{Authorization:"Bearer ".concat(i)}}),await n.A.get("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/verify-on-mount"),{headers:{Authorization:"Bearer ".concat(i)}});let e=(0,s.s)(i);console.log("[processQueueInformation] Valid token found:",e),u(!0),"id"in e?(console.log("[processQueueInformation] Redirecting to /form."),r.replace("/form")):"queueID"in e&&"stationID"in e?(console.log("[processQueueInformation] Redirecting to /queue-status."),r.replace("/queue-status")):(console.warn("[processQueueInformation] Unexpected token structure."),r.replace("/error/unauthorized"))}catch(e){if((0,a.F0)(e)){var c,l;console.error("[processQueueInformation] Axios error:",null===(c=e.response)||void 0===c?void 0:c.data.message),(null===(l=e.response)||void 0===l?void 0:l.status)===401?(localStorage.removeItem("token"),r.replace("/error/unauthorized")):r.replace("/error/internal-server-error")}}})()},[]),(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen text-center px-6 transition-opacity duration-500 ".concat(o?"opacity-0":"opacity-100"),children:[(0,t.jsx)("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin mb-6"}),(0,t.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Fetching your queue..."}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait while we get your spot in line."})]})};function l(){return(0,c.useEffect)(()=>{"serviceWorker"in navigator?navigator.serviceWorker.register("/firebase-messaging-sw.js").then(()=>console.log("Service Worker Registered")).catch(e=>console.error("Service Worker registration failed:",e)):console.warn("Service Workers are not supported in this browser.")},[]),(0,t.jsx)(c.Suspense,{fallback:(0,t.jsx)("p",{children:"Loading..."}),children:(0,t.jsx)(u,{})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[451,441,517,358],()=>r(2721)),_N_E=e.O()}]);