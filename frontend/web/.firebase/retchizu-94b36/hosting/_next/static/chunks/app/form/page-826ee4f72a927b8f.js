(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[381],{3633:(e,t,a)=>{Promise.resolve().then(a.bind(a,557))},557:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>O});var s=a(5155),r=a(106),l=a(4085),n=a(2115),o=a(9602);let i=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("rounded-xl border bg-card text-card-foreground shadow",a),...r})});i.displayName="Card";let d=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex flex-col space-y-1.5 p-6",a),...r})});d.displayName="CardHeader";let c=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("font-semibold leading-none tracking-tight",a),...r})});c.displayName="CardTitle";let u=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("text-sm text-muted-foreground",a),...r})});u.displayName="CardDescription";let m=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("p-6 pt-0",a),...r})});m.displayName="CardContent";let f=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)("div",{ref:t,className:(0,o.cn)("flex items-center p-6 pt-0",a),...r})});f.displayName="CardFooter";let x=n.forwardRef((e,t)=>{let{className:a,type:r,...l}=e;return(0,s.jsx)("input",{type:r,className:(0,o.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:t,...l})});x.displayName="Input";var p=a(6195);let h=(0,a(1027).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),g=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(p.b,{ref:t,className:(0,o.cn)(h(),a),...r})});g.displayName=p.b.displayName;var y=a(4850),v=a(2645),b=a(2488),j=a(7193);let N=y.bL,w=y.YJ,k=y.WT,F=n.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(y.l9,{ref:t,className:(0,o.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,s.jsx)(y.In,{asChild:!0,children:(0,s.jsx)(v.A,{className:"h-4 w-4 opacity-50"})})]})});F.displayName=y.l9.displayName;let S=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(y.PP,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(b.A,{className:"h-4 w-4"})})});S.displayName=y.PP.displayName;let C=n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(y.wn,{ref:t,className:(0,o.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,s.jsx)(v.A,{className:"h-4 w-4"})})});C.displayName=y.wn.displayName;let R=n.forwardRef((e,t)=>{let{className:a,children:r,position:l="popper",...n}=e;return(0,s.jsx)(y.ZL,{children:(0,s.jsxs)(y.UC,{ref:t,className:(0,o.cn)("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,s.jsx)(S,{}),(0,s.jsx)(y.LM,{className:(0,o.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,s.jsx)(C,{})]})})});R.displayName=y.UC.displayName,n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(y.JU,{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=y.JU.displayName;let A=n.forwardRef((e,t)=>{let{className:a,children:r,...l}=e;return(0,s.jsxs)(y.q7,{ref:t,className:(0,o.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(y.VF,{children:(0,s.jsx)(j.A,{className:"h-4 w-4"})})}),(0,s.jsx)(y.p4,{children:r})]})});A.displayName=y.q7.displayName,n.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(y.wv,{ref:t,className:(0,o.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=y.wv.displayName;var z=a(7946),B=a(6522),E=a(2651),I=a(3205),q=a(8698);let D=(e,t,a)=>{let[s,r]=(0,n.useState)(!0),[l,o]=(0,n.useState)([]),[i,d]=(0,n.useState)(null);return console.log(e),(0,n.useEffect)(()=>{let s=(0,q.KR)(z.Y,"current-serving"),l=async()=>{if(0!==e.length)try{r(!0);let a=await E.A.post("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/available-stations"),{purpose:e},{headers:{Authorization:"Bearer ".concat(t)}});console.log(a.data.availableStations),o(a.data.availableStations)}catch(e){if((0,I.F0)(e)){var s;(null===(s=e.response)||void 0===s?void 0:s.status)===401&&(localStorage.removeItem("token"),a.replace("/error/unauthorized")),d(e.message)}else console.error(e),d(e.message)}finally{r(!1)}},n=(0,q.Zy)(s,()=>{l()});return()=>n()},[e]),{cashiers:l,isAvailableCashierFetching:s,error:i}};var T=a(8569),P=a(4448);let U=async(e,t,a,s)=>{try{let{queueToken:r,queueNumber:l}=(await E.A.post("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/add"),{stationID:a,purpose:e,email:t,timestamp:Date.now()},{headers:{Authorization:"Bearer ".concat(s)}})).data;return{queueToken:r,queueID:l}}catch(e){if((0,I.F0)(e)&&e.response){let{data:t,status:a}=e.response;throw{message:t.message||"An unexpected error occurred",status:a}}throw e}},V=e=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e);var J=a(9903),_=a(6046);let O=()=>{let[e,t]=(0,n.useState)(""),[a,o]=(0,n.useState)(""),[p,h]=(0,n.useState)(!1),y=(0,_.useRouter)(),[v,b]=(0,n.useState)(0),[j,S]=(0,n.useState)(!1),{token:C}=(0,T.W)(y),{cashiers:E,isAvailableCashierFetching:I,error:q}=D(e,C,y),{alertMessage:O,setAlertMessage:W,isAlertOpen:Y,setIsAlertOpen:L}=(0,B.x)(q);(0,n.useEffect)(()=>{C&&z.B&&((async()=>{if(z.B)try{let e=await Notification.requestPermission();if("granted"===e){console.log("did run");let e=await (0,J.gf)(z.B,{vapidKey:"BKw0WhFqtEyOa2xX7ysD2aZegr9wToVNcAiBIKXzhy4RIRoFJ2v5f-wvPxJdrHOxD-zNC2W1YGeJYfCAE4Zal10"});localStorage.setItem("fcmtoken",e)}}catch(e){W(e.message),L(!0)}})(),(0,J.xD)(z.B,e=>{var t,a;console.log("Message received in foreground:",e),alert("".concat(null===(t=e.notification)||void 0===t?void 0:t.title," ").concat(null===(a=e.notification)||void 0===a?void 0:a.body))}))},[C]),(0,n.useEffect)(()=>{let e=setTimeout(()=>h(!0),100);return()=>clearTimeout(e)},[]);let Z=t=>{let{cashier:r}=t;return(0,s.jsxs)(i,{className:"border-2 border-[#FFC107] shadow-md w-full sm:max-w-lg min-w-[200px] mx-auto",children:[(0,s.jsxs)(d,{className:"flex flex-col justify-between items-start sm:items-center p-2 sm:p-4",children:[(0,s.jsx)("div",{className:"font-semibold text-sm sm:text-lg",children:r.name}),(0,s.jsxs)("div",{className:"text-xs sm:text-sm",children:["Estimated Wait Time:"," ",(0,s.jsx)("span",{className:"text-red-600 font-bold",children:(0,P.A)((0,P.g)(r.queueSize))})]})]}),(0,s.jsxs)(m,{className:"px-2 sm:px-4 pb-2 text-xs sm:text-sm",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Location:"})," ",r.description]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"People in Queue:"})," ",r.queueSize]})]}),(0,s.jsx)(f,{className:"p-2 sm:p-4 flex justify-center",children:(0,s.jsx)(l.$,{className:"w-full max-w-xs bg-[#0077B6] text-white font-semibold hover:bg-blue-800 text-xs sm:text-sm",onClick:async()=>{try{S(!0);let{queueToken:t,queueID:s}=await U(e,a,r.id,C);localStorage.setItem("token",t),localStorage.setItem("queueID",s),console.log("token new",t),y.replace("/queue-status")}catch(e){W(e.message),L(!0),401===e.status?y.replace("/error/unauthorized"):500===e.status?y.replace("/error/internal-server-error"):y.replace("/error/general-error")}finally{S(!1)}},children:j?(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"w-5 h-5 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin"})}):"Enter Queue"})})]},r.id)};return(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 p-6 pb-16 transition-all duration-700 ".concat(p?"opacity-100 translate-y-0":"opacity-0 translate-y-4"),children:[(0,s.jsxs)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-[#0077B6] text-center",children:["NEU",(0,s.jsx)("span",{className:"text-[#FFBF00]",children:"QUEUE"})]}),(0,s.jsx)("p",{className:"text-gray-700 mt-2 text-center font-bold text-sm sm:text-base",children:"Thank you for scanning!"}),(0,s.jsxs)("p",{className:"text-center text-gray-600 max-w-xs sm:max-w-md md:max-w-lg mt-2 font-bold text-xs sm:text-sm md:text-base",children:["Join a virtual queue and receive a notification or email when it’s your turn. ⏳"," ",(0,s.jsx)("span",{className:"text-red-500 font-bold",children:"You have 10 minutes to submit the form"})," ","or scan the QR code again."]}),(0,s.jsx)("p",{className:"text-gray-600 mt-2 text-center text-xs sm:text-sm md:text-base",children:"Wait for an Email notification shortly."}),(0,s.jsxs)(i,{className:"w-full max-w-md sm:max-w-lg mt-4 min-h-[300px] sm:min-h-[350px] md:min-h-[300px]",children:[(0,s.jsxs)(d,{children:[(0,s.jsx)(c,{children:0===v?"Required Section":"Select a Cashier"}),(0,s.jsx)(u,{children:0===v?"Enter your SMS details to proceed.":"Choose an available cashier and confirm."})]}),(0,s.jsx)(m,{children:0===v?(0,s.jsxs)("div",{className:"grid w-full gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(g,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsxs)(N,{onValueChange:t,value:e,children:[(0,s.jsx)(F,{id:"purpose",className:"border-[#FFBF00]",children:(0,s.jsx)(k,{placeholder:"Select a purpose"})}),(0,s.jsx)(R,{children:(0,s.jsx)(w,{children:["payment","auditing","clinic","registrar"].map(e=>(0,s.jsx)(A,{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})})]})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(g,{htmlFor:"email",children:"Email Address(required)"}),(0,s.jsx)(x,{id:"email",placeholder:"Enter your Email Address",className:"border-[#FFBF00]",value:a,onChange:e=>o(e.target.value)})]})]}):(0,s.jsxs)("div",{className:"max-w-full sm:max-w-2xl mx-auto mt-1 p-4",children:[(0,s.jsx)("h2",{className:"text-lg font-bold mb-2",children:"Available Counters:"}),I?(0,s.jsx)(()=>(0,s.jsx)("div",{className:"flex justify-center items-center h-40",children:(0,s.jsx)("div",{className:"w-10 h-10 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin"})}),{}):(0,s.jsx)("div",{className:"space-y-4 max-h-80 overflow-y-auto w-full px-2 sm:px-4",children:E.map(e=>(0,s.jsx)(Z,{cashier:e},e.id))})]})}),(0,s.jsx)(f,{className:"flex justify-between",children:0===v?(0,s.jsx)(l.$,{className:"w-40 bg-[#0077B6] text-[#FFBF00] font-bold",onClick:()=>b(1),disabled:!(V(a)&&e.trim()),children:"Proceed"}):(0,s.jsx)(l.$,{className:"w-20 bg-[#0077B6] text-[#FFBF00] font-bold",onClick:()=>b(0),children:"Back"})})]}),(0,s.jsx)("p",{className:"text-gray-600 font-extrabold mt-4 text-sm text-center",children:"Always check your email and notifications. Thank you!"}),(0,s.jsx)(r.A,{alertMessage:O,isAlertOpen:Y,setIsAlertOpen:L})]})}},106:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var s=a(5155),r=a(2115),l=a(5724),n=a(9602),o=a(4085);let i=l.bL;l.l9;let d=l.ZL,c=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hJ,{className:(0,n.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r,ref:t})});c.displayName=l.hJ.displayName;let u=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsxs)(d,{children:[(0,s.jsx)(c,{}),(0,s.jsx)(l.UC,{ref:t,className:(0,n.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...r})]})});u.displayName=l.UC.displayName;let m=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...a})};m.displayName="AlertDialogHeader";let f=e=>{let{className:t,...a}=e;return(0,s.jsx)("div",{className:(0,n.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...a})};f.displayName="AlertDialogFooter";let x=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.hE,{ref:t,className:(0,n.cn)("text-lg font-semibold",a),...r})});x.displayName=l.hE.displayName;let p=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.VY,{ref:t,className:(0,n.cn)("text-sm text-muted-foreground",a),...r})});p.displayName=l.VY.displayName;let h=r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.rc,{ref:t,className:(0,n.cn)((0,o.r)(),a),...r})});h.displayName=l.rc.displayName,r.forwardRef((e,t)=>{let{className:a,...r}=e;return(0,s.jsx)(l.ZD,{ref:t,className:(0,n.cn)((0,o.r)({variant:"outline"}),"mt-2 sm:mt-0",a),...r})}).displayName=l.ZD.displayName;let g=e=>{let{isAlertOpen:t,setIsAlertOpen:a,alertMessage:r}=e;return(0,s.jsx)(i,{open:t,onOpenChange:a,children:(0,s.jsxs)(u,{children:[(0,s.jsxs)(m,{children:[(0,s.jsx)(x,{children:"Notification"}),(0,s.jsx)(p,{children:r})]}),(0,s.jsx)(f,{children:(0,s.jsx)(h,{onClick:()=>a(!1),children:"OK"})})]})})}},4085:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,r:()=>i});var s=a(5155),r=a(2115),l=a(2317),n=a(1027),o=a(9602);let i=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=r.forwardRef((e,t)=>{let{className:a,variant:r,size:n,asChild:d=!1,...c}=e,u=d?l.DX:"button";return(0,s.jsx)(u,{className:(0,o.cn)(i({variant:r,size:n,className:a})),ref:t,...c})});d.displayName="Button"},7946:(e,t,a)=>{"use strict";a.d(t,{B:()=>i,Y:()=>o});var s=a(9904),r=a(8698),l=a(9903);let n=(0,s.Dk)().length?(0,s.Sx)():(0,s.Wp)({apiKey:"AIzaSyBpCd7IRFoEXJojdSSiEXvGookmp3fkX6o",authDomain:"retchizu-94b36.firebaseapp.com",databaseURL:"https://retchizu-94b36-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"retchizu-94b36",storageBucket:"retchizu-94b36.firebasestorage.app",messagingSenderId:"494547462196",appId:"1:494547462196:web:72940d101936381e194261cea"}),o=(0,r.C3)(n),i=null;i=(0,l.dG)(n),(0,l.xD)(i,e=>{var t,a;console.log("Foreground Message received:",e),alert("Notification: ".concat(null===(t=e.notification)||void 0===t?void 0:t.title," - ").concat(null===(a=e.notification)||void 0===a?void 0:a.body))})},6522:(e,t,a)=>{"use strict";a.d(t,{x:()=>r});var s=a(2115);let r=e=>{let[t,a]=(0,s.useState)(""),[r,l]=(0,s.useState)(!1);return(0,s.useEffect)(()=>{e&&(a(e),l(!0))},[e]),{alertMessage:t,isAlertOpen:r,setAlertMessage:a,setIsAlertOpen:l}}},8569:(e,t,a)=>{"use strict";a.d(t,{W:()=>i});var s=a(2651),r=a(3205),l=a(7684),n=a(6046),o=a(2115);let i=e=>{let t=(0,n.usePathname)(),[a,i]=(0,o.useState)(null),[d,c]=(0,o.useState)(null);return(0,o.useEffect)(()=>{let a=localStorage.getItem("token");if(console.log("in local storage",a),!a){e.replace("error/unauthorized");return}(async()=>{try{await s.A.get("".concat("https://neu-43k5gfcwva-uc.a.run.app","/queue/verify-on-mount"),{headers:{Authorization:"Bearer ".concat(a)}});let r=(0,l.s)(a);c(r),"id"in r&&"/form"!==t?(console.log("[useVerifyValidToken] Detected newToken, redirecting to form."),e.replace("/form")):"queueID"in r&&"stationID"in r&&"/queue-status"!==t?(console.log("[useVerifyValidToken] Detected pendingToken, redirecting to queue-status."),e.replace("/queue-status")):"id"in r||"queueID"in r||(console.warn("[useVerifyValidToken] Unexpected token structure."),e.replace("/error/unauthorized")),i(a)}catch(t){if((0,r.F0)(t)){var n,o;console.log(null===(n=t.response)||void 0===n?void 0:n.data.message),(null===(o=t.response)||void 0===o?void 0:o.status)===401?(e.replace("/error/unauthorized"),localStorage.removeItem("token")):e.replace("/error/internal-server-error")}}})()},[]),{token:a,decodedToken:d}}},9602:(e,t,a)=>{"use strict";a.d(t,{cn:()=>l});var s=a(3463),r=a(9795);function l(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,r.QP)((0,s.$)(t))}},4448:(e,t,a)=>{"use strict";a.d(t,{A:()=>r,g:()=>s});let s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return e*t},r=e=>{let t=Math.floor(e/60),a=e%60;return t>0?"".concat(t," hour ").concat(a," minutes"):"".concat(a," minutes")}}},e=>{var t=t=>e(e.s=t);e.O(0,[507,451,988,570,441,517,358],()=>t(3633)),_N_E=e.O()}]);