(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7664:(e,t,r)=>{Promise.resolve().then(r.bind(r,6427))},6427:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>L});var s=r(5155),a=r(2115),o=r(2651),n=r(6046),l=r(2317),i=r(1027),d=r(3463),c=r(9795);function u(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,c.QP)((0,d.$)(t))}let m=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),f=a.forwardRef((e,t)=>{let{className:r,variant:a,size:o,asChild:n=!1,...i}=e,d=n?l.DX:"button";return(0,s.jsx)(d,{className:u(m({variant:a,size:o,className:r})),ref:t,...i})});f.displayName="Button";let p=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("rounded-xl border bg-card text-card-foreground shadow",r),...a})});p.displayName="Card";let h=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("flex flex-col space-y-1.5 p-6",r),...a})});h.displayName="CardHeader";let x=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("font-semibold leading-none tracking-tight",r),...a})});x.displayName="CardTitle";let g=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("text-sm text-muted-foreground",r),...a})});g.displayName="CardDescription";let y=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("p-6 pt-0",r),...a})});y.displayName="CardContent";let b=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)("div",{ref:t,className:u("flex items-center p-6 pt-0",r),...a})});b.displayName="CardFooter";let w=a.forwardRef((e,t)=>{let{className:r,type:a,...o}=e;return(0,s.jsx)("input",{type:a,className:u("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...o})});w.displayName="Input";var j=r(6195);let N=(0,i.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),v=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(j.b,{ref:t,className:u(N(),r),...a})});v.displayName=j.b.displayName;var F=r(4957),k=r(2645),R=r(2488),S=r(7193);let q=F.bL,C=F.YJ,P=F.WT,A=a.forwardRef((e,t)=>{let{className:r,children:a,...o}=e;return(0,s.jsxs)(F.l9,{ref:t,className:u("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",r),...o,children:[a,(0,s.jsx)(F.In,{asChild:!0,children:(0,s.jsx)(k.A,{className:"h-4 w-4 opacity-50"})})]})});A.displayName=F.l9.displayName;let E=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(F.PP,{ref:t,className:u("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(R.A,{className:"h-4 w-4"})})});E.displayName=F.PP.displayName;let I=a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(F.wn,{ref:t,className:u("flex cursor-default items-center justify-center py-1",r),...a,children:(0,s.jsx)(k.A,{className:"h-4 w-4"})})});I.displayName=F.wn.displayName;let D=a.forwardRef((e,t)=>{let{className:r,children:a,position:o="popper",...n}=e;return(0,s.jsx)(F.ZL,{children:(0,s.jsxs)(F.UC,{ref:t,className:u("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===o&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",r),position:o,...n,children:[(0,s.jsx)(E,{}),(0,s.jsx)(F.LM,{className:u("p-1","popper"===o&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,s.jsx)(I,{})]})})});D.displayName=F.UC.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(F.JU,{ref:t,className:u("px-2 py-1.5 text-sm font-semibold",r),...a})}).displayName=F.JU.displayName;let B=a.forwardRef((e,t)=>{let{className:r,children:a,...o}=e;return(0,s.jsxs)(F.q7,{ref:t,className:u("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...o,children:[(0,s.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,s.jsx)(F.VF,{children:(0,s.jsx)(S.A,{className:"h-4 w-4"})})}),(0,s.jsx)(F.p4,{children:a})]})});B.displayName=F.q7.displayName,a.forwardRef((e,t)=>{let{className:r,...a}=e;return(0,s.jsx)(F.wv,{ref:t,className:u("-mx-1 my-1 h-px bg-muted",r),...a})}).displayName=F.wv.displayName;let U="https://neu-43k5gfcwva-uc.a.run.app/",z=async(e,t,r,s)=>{if(!e)throw Error("Queue ID is missing.");if(!t)throw Error("Please select a purpose.");if(!r||r.length<10)throw Error("Invalid phone number.");if(!s)throw Error("Missing authentication token.");let a={queueID:e,purpose:t,cellphoneNumber:r,customerStatus:"pending",createdAt:new Date().toISOString()};console.log("Using environment URL:",U),console.log("Submitting with token:",s),console.log("Final request URL:","".concat(U,"/queue/add"));try{return(await o.A.post("".concat(U,"/queue/add"),a,{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(s.trim())}})).data}catch(e){throw console.error("Axios request failed:",e),e}},T=async(e,t)=>{if(!e){console.error("Token is missing.");return}let r="".concat(t,"/queue/notify");console.log("Sending notification to: ".concat(r));try{let t=await o.A.post(r,{},{headers:{Authorization:"Bearer ".concat(e)}});return console.log("Notification sent successfully:",t.data),t.data}catch(e){throw console.error("Error notifying queue:",e),e}},_=()=>{let e=(0,n.useSearchParams)(),t=(0,n.useRouter)(),r=e.get("token"),[l,i]=(0,a.useState)(""),[d,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!1),[j,N]=(0,a.useState)(null),[F,k]=(0,a.useState)(!0),R="https://neu-43k5gfcwva-uc.a.run.app/";console.log("Initial token:",r),console.log("API URL:",R),(0,a.useEffect)(()=>{r||(console.warn("No token found, redirecting to unauthorized page."),t.replace("/error/unauthorized"))},[r,t]),(0,a.useEffect)(()=>{(async()=>{if(!r){console.warn("Missing token, skipping fetch.");return}if(!R){console.error("API URL is missing from environment variables.");return}let e="".concat(R,"/queue/current");console.log("Fetching queue ID from: ".concat(e));try{let t=await o.A.get(e,{headers:{Authorization:"Bearer ".concat(r)}});console.log("Queue ID fetch response:",t.data),N(t.data.queueID),k(!1),t.data.queueID&&await T(r,R)}catch(e){console.error("Failed to fetch queue ID:",e),k(!1)}})()},[r,R]);let S=async()=>{if(console.log("Submit button clicked"),console.log("Current form values:",{queueID:j,purpose:l,phoneNumber:d}),!l||!d||!j){console.warn("Form validation failed: Missing required fields."),alert("Please fill out all fields.");return}console.log("Token before submission:",r),m(!0);try{let e=await z(j,l,d,r);console.log("Form submitted successfully:",e),alert("Form submitted successfully!")}catch(e){console.error("Error submitting form:",e),alert("Failed to submit form. Please try again.")}finally{m(!1)}};return(0,s.jsx)("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-100 p-6",children:F?(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h2",{className:"text-xl mb-4",children:"Fetching your place in the queue..."}),(0,s.jsx)("div",{className:"animate-spin text-6xl mb-4",children:"\uD83D\uDD04"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 font-bold",children:"Just a moment... we're getting your spot in line!"}),(0,s.jsx)("p",{className:"mt-2 text-sm text-gray-500",children:"Please hold on while we grab your details."}),(0,s.jsx)("div",{className:"text-2xl mt-4 animate-pulse text-[#FFBF00]",children:"⏳ Your turn is coming soon!"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("h1",{className:"text-5xl font-bold",style:{color:"#0077B6"},children:["NEU",(0,s.jsx)("span",{style:{color:"#FFBF00"},children:"QUEUE"})]}),(0,s.jsx)("p",{className:"text-gray-650 mt-2 text-center font-bold",children:"Thank you for scanning!"}),(0,s.jsxs)("p",{className:"text-center text-gray-600 max-w-lg mt-2 font-bold",children:["This system helps manage queues efficiently, allowing you to join a virtual line without waiting physically. You’ll receive an SMS notification when it’s your turn. You only have to wait"," ",(0,s.jsx)("span",{className:"text-red-500 font-bold",children:"a couple of minutes"})," ","at most for you to be served at the cashier.⏳"]}),(0,s.jsxs)("h2",{className:"text-2xl font-semibold mt-4",style:{color:"#0077B6"},children:["Your queue ID is\xa0",(0,s.jsx)("span",{className:"font-bold",children:"#".concat(j||"&hellip;")}),"."]}),(0,s.jsx)("p",{className:"text-gray-600 mt-2 text-center",children:"Please wait for an SMS notification, which will be sent to you shortly."}),(0,s.jsxs)(p,{className:"w-[350px] mt-6",children:[(0,s.jsxs)(h,{children:[(0,s.jsx)(x,{children:"Required section"}),(0,s.jsx)(g,{children:"To proceed, please enter your SMS details."})]}),(0,s.jsx)(y,{children:(0,s.jsxs)("div",{className:"grid w-full items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(v,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsxs)(q,{onValueChange:i,children:[(0,s.jsx)(A,{id:"purpose",className:"border-[#FFBF00]",children:(0,s.jsx)(P,{placeholder:"Select a purpose"})}),(0,s.jsx)(D,{children:(0,s.jsxs)(C,{children:[(0,s.jsx)(B,{value:"inquiry",children:"Inquiry"}),(0,s.jsx)(B,{value:"payment",children:"Payment"})]})})]})]}),(0,s.jsxs)("div",{className:"flex flex-col space-y-1.5",children:[(0,s.jsx)(v,{htmlFor:"phone",children:"Cellphone Number (required)"}),(0,s.jsx)(w,{id:"phone",placeholder:"Enter your cellphone number",className:"border-[#FFBF00]",value:d,onChange:e=>c(e.target.value)})]})]})}),(0,s.jsx)(b,{className:"flex justify-center",children:(0,s.jsx)(f,{className:"w-40",style:{backgroundColor:"#0077B6",color:"#FFBF00"},onClick:S,disabled:u,children:u?"Submitting...":(0,s.jsx)("span",{className:"font-bold",children:"Submit"})})})]}),(0,s.jsx)("p",{className:"text-gray-600 font-extrabold mt-4 text-sm",children:"Remember to always check your notifications. Thank you!"})]})})};function L(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"Loading..."}),children:(0,s.jsx)(_,{})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[683,441,517,358],()=>t(7664)),_N_E=e.O()}]);