(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{7664:(e,t,r)=>{Promise.resolve().then(r.bind(r,4236))},4236:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>l});var o=r(5155),n=r(4459),a=r(6046),s=r(2115),u=r(7684);let i=()=>{let e=(0,a.useSearchParams)(),t=e.get("token"),r=(0,a.useRouter)(),{setQueueNumber:i,setToken:l}=(0,n.e)(),[c,d]=(0,s.useState)(!1),m=async()=>{if(!t){console.error("[LoadingComponent] Token is missing.");return}try{let e=(0,u.s)(t),o=e.queueNumber;o?(i(o),l(t),localStorage.setItem("queueNumber",o.toString()),localStorage.setItem("token",t),d(!0),setTimeout(()=>{r.replace("/form")},500),console.log("[LoadingComponent] Decoded token:",e)):console.error("[LoadingComponent] Queue number is not available in token.")}catch(e){console.error("[LoadingComponent] Error decoding token:",e),r.replace("/error/unauthorized")}};return(0,s.useEffect)(()=>{console.log("test"),m()},[r,e,i,l,t]),(0,o.jsxs)("div",{className:"flex flex-col justify-center items-center h-screen text-center px-6 transition-opacity duration-500 ".concat(c?"opacity-0":"opacity-100"),children:[(0,o.jsx)("div",{className:"w-12 h-12 border-4 border-gray-300 border-t-[#FFBF00] rounded-full animate-spin mb-6"}),(0,o.jsx)("h2",{className:"text-xl font-semibold text-gray-700",children:"Fetching your queue..."}),(0,o.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Please wait while we get your spot in line."})]})};function l(){return(0,o.jsx)(s.Suspense,{children:(0,o.jsx)(i,{})})}},4459:(e,t,r)=>{"use strict";r.d(t,{QueueProvider:()=>u,e:()=>i});var o=r(5155),n=r(2115),a=r(7684);let s=(0,n.createContext)(void 0),u=e=>{let{children:t}=e,[r,u]=(0,n.useState)(0),[i,l]=(0,n.useState)(null);return(0,n.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("queueNumber");if(e)try{let t=(0,a.s)(e).exp;t&&t<Math.floor(Date.now()/1e3)?(console.warn("[QueueProvider] Token expired. Removing from local storage."),localStorage.removeItem("token"),localStorage.removeItem("queueNumber"),l(null),u(0)):l(e)}catch(e){console.error("[QueueProvider] Failed to decode token:",e),localStorage.removeItem("token"),localStorage.removeItem("queueNumber"),l(null),u(0)}t&&u(Number(t))},[]),(0,o.jsx)(s.Provider,{value:{queueNumber:r,setQueueNumber:u,token:i,setToken:l},children:t})},i=()=>{let e=(0,n.useContext)(s);if(!e)throw Error("useQueueContext must be used within a QueueProvider");return e}},6046:(e,t,r)=>{"use strict";var o=r(6658);r.o(o,"useRouter")&&r.d(t,{useRouter:function(){return o.useRouter}}),r.o(o,"useSearchParams")&&r.d(t,{useSearchParams:function(){return o.useSearchParams}})},7684:(e,t,r)=>{"use strict";r.d(t,{s:()=>n});class o extends Error{}function n(e,t){let r;if("string"!=typeof e)throw new o("Invalid token specified: must be a string");t||(t={});let n=!0===t.header?0:1,a=e.split(".")[n];if("string"!=typeof a)throw new o(`Invalid token specified: missing part #${n+1}`);try{r=function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw Error("base64 string is not of the correct length")}try{var r;return r=t,decodeURIComponent(atob(r).replace(/(.)/g,(e,t)=>{let r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}catch(e){return atob(t)}}(a)}catch(e){throw new o(`Invalid token specified: invalid base64 for part #${n+1} (${e.message})`)}try{return JSON.parse(r)}catch(e){throw new o(`Invalid token specified: invalid json for part #${n+1} (${e.message})`)}}o.prototype.name="InvalidTokenError"}},e=>{var t=t=>e(e.s=t);e.O(0,[441,517,358],()=>t(7664)),_N_E=e.O()}]);